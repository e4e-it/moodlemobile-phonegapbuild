{"version":3,"sources":["../../src/addon/calendar/pages/list/list.module.ts","../../src/addon/calendar/pages/list/list.ts"],"names":[],"mappings":"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","file":"113.js","sourcesContent":["// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { CoreComponentsModule } from '@components/components.module';\r\nimport { CoreDirectivesModule } from '@directives/directives.module';\r\nimport { CorePipesModule } from '@pipes/pipes.module';\r\nimport { AddonCalendarListPage } from './list';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        AddonCalendarListPage,\r\n    ],\r\n    imports: [\r\n        CoreComponentsModule,\r\n        CoreDirectivesModule,\r\n        CorePipesModule,\r\n        IonicPageModule.forChild(AddonCalendarListPage),\r\n        TranslateModule.forChild()\r\n    ],\r\n})\r\nexport class AddonCalendarListPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/calendar/pages/list/list.module.ts","// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Component, ViewChild, OnDestroy } from '@angular/core';\r\nimport { IonicPage, Content, PopoverController, NavParams, NavController } from 'ionic-angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { AddonCalendarProvider } from '../../providers/calendar';\r\nimport { AddonCalendarHelperProvider } from '../../providers/helper';\r\nimport { CoreCoursesProvider } from '@core/courses/providers/courses';\r\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\r\nimport { CoreUtilsProvider } from '@providers/utils/utils';\r\nimport { CoreSitesProvider } from '@providers/sites';\r\nimport { CoreLocalNotificationsProvider } from '@providers/local-notifications';\r\nimport { CoreCoursePickerMenuPopoverComponent } from '@components/course-picker-menu/course-picker-menu-popover';\r\nimport { CoreEventsProvider } from '@providers/events';\r\nimport { CoreAppProvider } from '@providers/app';\r\nimport { CoreSplitViewComponent } from '@components/split-view/split-view';\r\n\r\n/**\r\n * Page that displays the list of calendar events.\r\n */\r\n@IonicPage({ segment: 'addon-calendar-list' })\r\n@Component({\r\n    selector: 'page-addon-calendar-list',\r\n    templateUrl: 'list.html',\r\n})\r\nexport class AddonCalendarListPage implements OnDestroy {\r\n    @ViewChild(Content) content: Content;\r\n    @ViewChild(CoreSplitViewComponent) splitviewCtrl: CoreSplitViewComponent;\r\n\r\n    protected daysLoaded = 0;\r\n    protected emptyEventsTimes = 0; // Variable to identify consecutive calls returning 0 events.\r\n    protected categoriesRetrieved = false;\r\n    protected getCategories = false;\r\n    protected allCourses = {\r\n        id: -1,\r\n        fullname: this.translate.instant('core.fulllistofcourses'),\r\n        category: -1\r\n    };\r\n    protected categories = {};\r\n    protected siteHomeId: number;\r\n    protected obsDefaultTimeChange: any;\r\n    protected eventId: number;\r\n\r\n    courses: any[];\r\n    eventsLoaded = false;\r\n    events = [];\r\n    notificationsEnabled = false;\r\n    filteredEvents = [];\r\n    canLoadMore = false;\r\n    filter = {\r\n        course: this.allCourses\r\n    };\r\n\r\n    constructor(private translate: TranslateService, private calendarProvider: AddonCalendarProvider, navParams: NavParams,\r\n            private domUtils: CoreDomUtilsProvider, private coursesProvider: CoreCoursesProvider, private utils: CoreUtilsProvider,\r\n            private calendarHelper: AddonCalendarHelperProvider, sitesProvider: CoreSitesProvider,\r\n            localNotificationsProvider: CoreLocalNotificationsProvider, private popoverCtrl: PopoverController,\r\n            eventsProvider: CoreEventsProvider, private navCtrl: NavController, appProvider: CoreAppProvider) {\r\n\r\n        this.siteHomeId = sitesProvider.getCurrentSite().getSiteHomeId();\r\n        this.notificationsEnabled = localNotificationsProvider.isAvailable();\r\n        if (this.notificationsEnabled) {\r\n            // Re-schedule events if default time changes.\r\n            this.obsDefaultTimeChange = eventsProvider.on(AddonCalendarProvider.DEFAULT_NOTIFICATION_TIME_CHANGED, () => {\r\n                calendarProvider.scheduleEventsNotifications(this.events);\r\n            }, sitesProvider.getCurrentSiteId());\r\n        }\r\n\r\n        this.eventId = navParams.get('eventId') || false;\r\n    }\r\n\r\n    /**\r\n     * View loaded.\r\n     */\r\n    ionViewDidLoad(): void {\r\n        if (this.eventId) {\r\n            // There is an event to load, open the event in a new state.\r\n            this.gotoEvent(this.eventId);\r\n        }\r\n\r\n        this.fetchData().then(() => {\r\n            if (!this.eventId && this.splitviewCtrl.isOn() && this.events.length > 0) {\r\n                // Take first and load it.\r\n                this.gotoEvent(this.events[0].id);\r\n            }\r\n        }).finally(() => {\r\n            this.eventsLoaded = true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch all the data required for the view.\r\n     *\r\n     * @param {boolean} [refresh] Empty events array first.\r\n     * @return {Promise<any>} Promise resolved when done.\r\n     */\r\n    fetchData(refresh: boolean = false): Promise<any> {\r\n        this.daysLoaded = 0;\r\n        this.emptyEventsTimes = 0;\r\n\r\n        // Load courses for the popover.\r\n        return this.coursesProvider.getUserCourses(false).then((courses) => {\r\n            // Add \"All courses\".\r\n            courses.unshift(this.allCourses);\r\n            this.courses = courses;\r\n\r\n            return this.fetchEvents(refresh);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetches the events and updates the view.\r\n     *\r\n     * @param {boolean} [refresh] Empty events array first.\r\n     * @return {Promise<any>} Promise resolved when done.\r\n     */\r\n    fetchEvents(refresh: boolean = false): Promise<any> {\r\n        return this.calendarProvider.getEventsList(this.daysLoaded, AddonCalendarProvider.DAYS_INTERVAL).then((events) => {\r\n            this.daysLoaded += AddonCalendarProvider.DAYS_INTERVAL;\r\n            if (events.length === 0) {\r\n                this.emptyEventsTimes++;\r\n                if (this.emptyEventsTimes > 5) { // Stop execution if we retrieve empty list 6 consecutive times.\r\n                    this.canLoadMore = false;\r\n                    if (refresh) {\r\n                        this.events = [];\r\n                        this.filteredEvents = [];\r\n                    }\r\n                } else {\r\n                    // No events returned, load next events.\r\n                    return this.fetchEvents();\r\n                }\r\n            } else {\r\n                // Sort the events by timestart, they're ordered by id.\r\n                events.sort((a, b) => {\r\n                    return a.timestart - b.timestart;\r\n                });\r\n\r\n                events.forEach(this.calendarHelper.formatEventData.bind(this.calendarHelper));\r\n                this.getCategories = this.shouldLoadCategories(events);\r\n\r\n                if (refresh) {\r\n                    this.events = events;\r\n                } else {\r\n                    // Filter events with same ID. Repeated events are returned once per WS call, show them only once.\r\n                    this.events = this.utils.mergeArraysWithoutDuplicates(this.events, events, 'id');\r\n                }\r\n                this.filteredEvents = this.getFilteredEvents();\r\n                this.canLoadMore = true;\r\n\r\n                // Schedule notifications for the events retrieved (might have new events).\r\n                this.calendarProvider.scheduleEventsNotifications(this.events);\r\n            }\r\n\r\n            // Resize the content so infinite loading is able to calculate if it should load more items or not.\r\n            // @todo: Infinite loading is not working if content is not high enough.\r\n            this.content.resize();\r\n        }).catch((error) => {\r\n            this.domUtils.showErrorModalDefault(error, 'addon.calendar.errorloadevents', true);\r\n            this.canLoadMore = false; // Set to false to prevent infinite calls with infinite-loading.\r\n        }).then(() => {\r\n            // Success retrieving events. Get categories if needed.\r\n            if (this.getCategories) {\r\n                this.getCategories = false;\r\n\r\n                return this.loadCategories();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get filtered events.\r\n     *\r\n     * @return {any[]} Filtered events.\r\n     */\r\n    protected getFilteredEvents(): any[] {\r\n        if (this.filter.course.id == -1) {\r\n            // No filter, display everything.\r\n            return this.events;\r\n        }\r\n\r\n        return this.events.filter(this.shouldDisplayEvent.bind(this));\r\n    }\r\n\r\n    /**\r\n     * Check if an event should be displayed based on the filter.\r\n     *\r\n     * @param {any} event Event object.\r\n     * @return {boolean} Whether it should be displayed.\r\n     */\r\n    protected shouldDisplayEvent(event: any): boolean {\r\n        if (event.eventtype == 'user' || event.eventtype == 'site') {\r\n            // User or site event, display it.\r\n            return true;\r\n        }\r\n\r\n        if (event.eventtype == 'category') {\r\n            if (!event.categoryid || !Object.keys(this.categories).length) {\r\n                // We can't tell if the course belongs to the category, display them all.\r\n                return true;\r\n            }\r\n            if (event.categoryid == this.filter.course.category) {\r\n                // The event is in the same category as the course, display it.\r\n                return true;\r\n            }\r\n\r\n            // Check parent categories.\r\n            let category = this.categories[this.filter.course.category];\r\n            while (category) {\r\n                if (!category.parent) {\r\n                    // Category doesn't have parent, stop.\r\n                    break;\r\n                }\r\n\r\n                if (event.categoryid == category.parent) {\r\n                    return true;\r\n                }\r\n                category = this.categories[category.parent];\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        // Show the event if it is from site home or if it matches the selected course.\r\n        return event.courseid === this.siteHomeId || event.courseid == this.filter.course.id;\r\n    }\r\n\r\n    /**\r\n     * Returns if the current state should load categories or not.\r\n     * @param {any[]} events Events to parse.\r\n     * @return {boolean}  True if categories should be loaded.\r\n     */\r\n    protected shouldLoadCategories(events: any[]): boolean {\r\n        if (this.categoriesRetrieved || this.getCategories) {\r\n            // Use previous value\r\n            return this.getCategories;\r\n        }\r\n\r\n        // Categories not loaded yet. We should get them if there's any category event.\r\n        const found = events.some((event) => event.categoryid != 'undefined' && event.categoryid > 0);\r\n\r\n        return found || this.getCategories;\r\n    }\r\n\r\n    /**\r\n     * Load categories to be able to filter events.\r\n     *\r\n     * @return {Promise<any>} Promise resolved when done.\r\n     */\r\n    protected loadCategories(): Promise<any> {\r\n        return this.coursesProvider.getCategories(0, true).then((cats) => {\r\n            this.categoriesRetrieved = true;\r\n            this.categories = {};\r\n            // Index categories by ID.\r\n            cats.forEach((category) => {\r\n                this.categories[category.id] = category;\r\n            });\r\n        }).catch(() => {\r\n            // Ignore errors.\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Refresh the events.\r\n     *\r\n     * @param {any} refresher Refresher.\r\n     */\r\n    refreshEvents(refresher: any): void {\r\n        const promises = [];\r\n\r\n        promises.push(this.calendarProvider.invalidateEventsList(this.courses));\r\n\r\n        if (this.categoriesRetrieved) {\r\n            promises.push(this.coursesProvider.invalidateCategories(0, true));\r\n            this.categoriesRetrieved = false;\r\n        }\r\n\r\n        Promise.all(promises).finally(() => {\r\n            this.fetchData(true).finally(() => {\r\n                refresher.complete();\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Show the context menu.\r\n     *\r\n     * @param {MouseEvent} event Event.\r\n     */\r\n    openCourseFilter(event: MouseEvent): void {\r\n        const popover = this.popoverCtrl.create(CoreCoursePickerMenuPopoverComponent, {\r\n            courses: this.courses,\r\n            courseId: this.filter.course.id\r\n        });\r\n        popover.onDidDismiss((course) => {\r\n            if (course) {\r\n                this.filter.course = course;\r\n                this.domUtils.scrollToTop(this.content);\r\n\r\n                this.filteredEvents = this.getFilteredEvents();\r\n            }\r\n        });\r\n        popover.present({\r\n            ev: event\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Open calendar events settings.\r\n     */\r\n    openSettings(): void {\r\n        this.navCtrl.push('AddonCalendarSettingsPage');\r\n    }\r\n\r\n    /**\r\n     * Navigate to a particular event.\r\n     *\r\n     * @param {number} eventId Event to load.\r\n     */\r\n    gotoEvent(eventId: number): void {\r\n        this.eventId = eventId;\r\n        this.splitviewCtrl.push('AddonCalendarEventPage', { id: eventId });\r\n    }\r\n\r\n    /**\r\n     * Page destroyed.\r\n     */\r\n    ngOnDestroy(): void {\r\n        this.obsDefaultTimeChange && this.obsDefaultTimeChange.off();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/calendar/pages/list/list.ts"],"sourceRoot":""}