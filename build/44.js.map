{"version":3,"sources":["../../src/core/courses/pages/categories/categories.module.ts","../../src/core/courses/pages/categories/categories.ts"],"names":[],"mappings":"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","file":"44.js","sourcesContent":["// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { CoreCoursesCategoriesPage } from './categories';\r\nimport { CoreComponentsModule } from '@components/components.module';\r\nimport { CoreDirectivesModule } from '@directives/directives.module';\r\nimport { CoreCoursesComponentsModule } from '../../components/components.module';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        CoreCoursesCategoriesPage,\r\n    ],\r\n    imports: [\r\n        CoreComponentsModule,\r\n        CoreCoursesComponentsModule,\r\n        CoreDirectivesModule,\r\n        IonicPageModule.forChild(CoreCoursesCategoriesPage),\r\n        TranslateModule.forChild()\r\n    ],\r\n})\r\nexport class CoreCoursesCategoriesPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/courses/pages/categories/categories.module.ts","// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { CoreSitesProvider } from '@providers/sites';\r\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\r\nimport { CoreUtilsProvider } from '@providers/utils/utils';\r\nimport { CoreCoursesProvider } from '../../providers/courses';\r\n\r\n/**\r\n * Page that displays a list of categories and the courses in the current category if any.\r\n */\r\n@IonicPage({ segment: 'core-courses-categories' })\r\n@Component({\r\n    selector: 'page-core-courses-categories',\r\n    templateUrl: 'categories.html',\r\n})\r\nexport class CoreCoursesCategoriesPage {\r\n    title: string;\r\n    currentCategory: any;\r\n    categories: any[] = [];\r\n    courses: any[] = [];\r\n    categoriesLoaded: boolean;\r\n\r\n    protected categoryId: number;\r\n\r\n    constructor(private navCtrl: NavController, navParams: NavParams, private coursesProvider: CoreCoursesProvider,\r\n            private domUtils: CoreDomUtilsProvider, private utils: CoreUtilsProvider, translate: TranslateService,\r\n            private sitesProvider: CoreSitesProvider) {\r\n        this.categoryId = navParams.get('categoryId') || 0;\r\n        this.title = translate.instant('core.courses.categories');\r\n    }\r\n\r\n    /**\r\n     * View loaded.\r\n     */\r\n    ionViewDidLoad(): void {\r\n        this.fetchCategories().finally(() => {\r\n            this.categoriesLoaded = true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch the categories.\r\n     *\r\n     * @return {Promise<any>} Promise resolved when done.\r\n     */\r\n    protected fetchCategories(): Promise<any> {\r\n        return this.coursesProvider.getCategories(this.categoryId, true).then((cats) => {\r\n            this.currentCategory = undefined;\r\n\r\n            cats.forEach((cat, index) => {\r\n                if (cat.id == this.categoryId) {\r\n                    this.currentCategory = cat;\r\n                    // Delete current Category to avoid problems with the formatTree.\r\n                    delete cats[index];\r\n                }\r\n            });\r\n\r\n            // Sort by depth and sortorder to avoid problems formatting Tree.\r\n            cats.sort((a, b) => {\r\n                if (a.depth == b.depth) {\r\n                    return (a.sortorder > b.sortorder) ? 1 : ((b.sortorder > a.sortorder) ? -1 : 0);\r\n                }\r\n\r\n                return a.depth > b.depth ? 1 : -1;\r\n            });\r\n\r\n            this.categories = this.utils.formatTree(cats, 'parent', 'id', this.categoryId);\r\n\r\n            if (this.currentCategory) {\r\n                this.title = this.currentCategory.name;\r\n\r\n                return this.coursesProvider.getCoursesByField('category', this.categoryId).then((courses) => {\r\n                    this.courses = courses;\r\n                }).catch((error) => {\r\n                    this.domUtils.showErrorModalDefault(error, 'core.courses.errorloadcourses', true);\r\n                });\r\n            }\r\n        }).catch((error) => {\r\n            this.domUtils.showErrorModalDefault(error, 'core.courses.errorloadcategories', true);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Refresh the categories.\r\n     *\r\n     * @param {any} refresher Refresher.\r\n     */\r\n    refreshCategories(refresher: any): void {\r\n        const promises = [];\r\n\r\n        promises.push(this.coursesProvider.invalidateUserCourses());\r\n        promises.push(this.coursesProvider.invalidateCategories(this.categoryId, true));\r\n        promises.push(this.coursesProvider.invalidateCoursesByField('category', this.categoryId));\r\n        promises.push(this.sitesProvider.getCurrentSite().invalidateConfig());\r\n\r\n        Promise.all(promises).finally(() => {\r\n            this.fetchCategories().finally(() => {\r\n                refresher.complete();\r\n            });\r\n        });\r\n    }\r\n    /**\r\n     * Open a category.\r\n     *\r\n     * @param {number} categoryId The category ID.\r\n     */\r\n    openCategory(categoryId: number): void {\r\n        this.navCtrl.push('CoreCoursesCategoriesPage', { categoryId: categoryId });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/courses/pages/categories/categories.ts"],"sourceRoot":""}