{"version":3,"sources":["../../src/addon/mod/assign/pages/submission-review/submission-review.module.ts","../../src/addon/mod/assign/pages/submission-review/submission-review.ts"],"names":[],"mappings":"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","file":"97.js","sourcesContent":["// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { CoreComponentsModule } from '@components/components.module';\r\nimport { CoreDirectivesModule } from '@directives/directives.module';\r\nimport { AddonModAssignComponentsModule } from '../../components/components.module';\r\nimport { AddonModAssignSubmissionReviewPage } from './submission-review';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        AddonModAssignSubmissionReviewPage,\r\n    ],\r\n    imports: [\r\n        CoreComponentsModule,\r\n        CoreDirectivesModule,\r\n        AddonModAssignComponentsModule,\r\n        IonicPageModule.forChild(AddonModAssignSubmissionReviewPage),\r\n        TranslateModule.forChild()\r\n    ],\r\n})\r\nexport class AddonModAssignSubmissionReviewPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/assign/pages/submission-review/submission-review.module.ts","// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\r\nimport { CoreAppProvider } from '@providers/app';\r\nimport { CoreCourseProvider } from '@core/course/providers/course';\r\nimport { AddonModAssignProvider } from '../../providers/assign';\r\nimport { AddonModAssignSubmissionComponent } from '../../components/submission/submission';\r\n\r\n/**\r\n * Page that displays a submission.\r\n */\r\n@IonicPage({ segment: 'addon-mod-assign-submission-review' })\r\n@Component({\r\n    selector: 'page-addon-mod-assign-submission-review',\r\n    templateUrl: 'submission-review.html',\r\n})\r\nexport class AddonModAssignSubmissionReviewPage implements OnInit {\r\n    @ViewChild(AddonModAssignSubmissionComponent) submissionComponent: AddonModAssignSubmissionComponent;\r\n\r\n    title: string; // Title to display.\r\n    moduleId: number; // Module ID the submission belongs to.\r\n    courseId: number; // Course ID the assignment belongs to.\r\n    submitId: number; //  User that did the submission.\r\n    blindId: number; // Blinded user ID (if it's blinded).\r\n    showGrade: boolean; // Whether to display the grade at start.\r\n    loaded: boolean; // Whether data has been loaded.\r\n    canSaveGrades: boolean; // Whether the user can save grades.\r\n\r\n    protected assign: any; // The assignment the submission belongs to.\r\n    protected blindMarking: boolean; // Whether it uses blind marking.\r\n    protected forceLeave = false; // To allow leaving the page without checking for changes.\r\n\r\n    constructor(navParams: NavParams, protected navCtrl: NavController, protected courseProvider: CoreCourseProvider,\r\n            protected appProvider: CoreAppProvider, protected assignProvider: AddonModAssignProvider) {\r\n\r\n        this.moduleId = navParams.get('moduleId');\r\n        this.courseId = navParams.get('courseId');\r\n        this.submitId = navParams.get('submitId');\r\n        this.blindId = navParams.get('blindId');\r\n        this.showGrade = !!navParams.get('showGrade');\r\n    }\r\n\r\n    /**\r\n     * Component being initialized.\r\n     */\r\n    ngOnInit(): void {\r\n        this.fetchSubmission().finally(() => {\r\n            this.loaded = true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Check if we can leave the page or not.\r\n     *\r\n     * @return {boolean|Promise<void>} Resolved if we can leave it, rejected if not.\r\n     */\r\n    ionViewCanLeave(): boolean | Promise<void> {\r\n        if (!this.submissionComponent || this.forceLeave) {\r\n            return true;\r\n        }\r\n\r\n        // Check if data has changed.\r\n        return this.submissionComponent.canLeave();\r\n    }\r\n\r\n    /**\r\n     * User entered the page.\r\n     */\r\n    ionViewDidEnter(): void {\r\n        this.submissionComponent && this.submissionComponent.ionViewDidEnter();\r\n    }\r\n\r\n    /**\r\n     * User left the page.\r\n     */\r\n    ionViewDidLeave(): void {\r\n        this.submissionComponent && this.submissionComponent.ionViewDidLeave();\r\n    }\r\n\r\n    /**\r\n     * Get the submission.\r\n     *\r\n     * @return {Promise<any>} Promise resolved when done.\r\n     */\r\n    protected fetchSubmission(): Promise<any> {\r\n        return this.assignProvider.getAssignment(this.courseId, this.moduleId).then((assignment) => {\r\n            this.assign = assignment;\r\n            this.title = this.assign.name;\r\n\r\n            this.blindMarking = this.assign.blindmarking && !this.assign.revealidentities;\r\n\r\n            return this.courseProvider.getModuleBasicGradeInfo(this.moduleId).then((gradeInfo) => {\r\n                if (gradeInfo) {\r\n                    // Grades can be saved if simple grading.\r\n                    if (gradeInfo.advancedgrading && gradeInfo.advancedgrading[0] &&\r\n                            typeof gradeInfo.advancedgrading[0].method != 'undefined') {\r\n\r\n                        const method = gradeInfo.advancedgrading[0].method || 'simple';\r\n                        this.canSaveGrades = method == 'simple';\r\n                    } else {\r\n                        this.canSaveGrades = true;\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Refresh all the data.\r\n     *\r\n     * @return {Promise<any>} Promise resolved when done.\r\n     */\r\n    protected refreshAllData(): Promise<any> {\r\n        const promises = [];\r\n\r\n        promises.push(this.assignProvider.invalidateAssignmentData(this.courseId));\r\n        if (this.assign) {\r\n            promises.push(this.assignProvider.invalidateSubmissionData(this.assign.id));\r\n            promises.push(this.assignProvider.invalidateAssignmentUserMappingsData(this.assign.id));\r\n            promises.push(this.assignProvider.invalidateSubmissionStatusData(this.assign.id, this.submitId, this.blindMarking));\r\n        }\r\n\r\n        return Promise.all(promises).finally(() => {\r\n            this.submissionComponent && this.submissionComponent.invalidateAndRefresh();\r\n\r\n            return this.fetchSubmission();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Refresh the data.\r\n     *\r\n     * @param {any} refresher Refresher.\r\n     */\r\n    refreshSubmission(refresher: any): void {\r\n        this.refreshAllData().finally(() => {\r\n            refresher.complete();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Submit a grade and feedback.\r\n     */\r\n    submitGrade(): void {\r\n        if (this.submissionComponent) {\r\n            this.submissionComponent.submitGrade().then(() => {\r\n                // Grade submitted, leave the view if not in tablet.\r\n                if (!this.appProvider.isWide()) {\r\n                    this.forceLeave = true;\r\n                    this.navCtrl.pop();\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/assign/pages/submission-review/submission-review.ts"],"sourceRoot":""}