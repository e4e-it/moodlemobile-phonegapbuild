{"version":3,"sources":["../../src/addon/mod/lesson/pages/user-retake/user-retake.module.ts","../../src/addon/mod/lesson/pages/user-retake/user-retake.ts"],"names":[],"mappings":"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","file":"70.js","sourcesContent":["// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { CoreComponentsModule } from '@components/components.module';\r\nimport { CoreDirectivesModule } from '@directives/directives.module';\r\nimport { CorePipesModule } from '@pipes/pipes.module';\r\nimport { AddonModLessonUserRetakePage } from './user-retake';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        AddonModLessonUserRetakePage,\r\n    ],\r\n    imports: [\r\n        CoreComponentsModule,\r\n        CoreDirectivesModule,\r\n        CorePipesModule,\r\n        IonicPageModule.forChild(AddonModLessonUserRetakePage),\r\n        TranslateModule.forChild()\r\n    ],\r\n})\r\nexport class AddonModLessonUserRetakePageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/lesson/pages/user-retake/user-retake.module.ts","// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { IonicPage, NavParams } from 'ionic-angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { CoreSitesProvider } from '@providers/sites';\r\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\r\nimport { CoreTextUtilsProvider } from '@providers/utils/text';\r\nimport { CoreTimeUtilsProvider } from '@providers/utils/time';\r\nimport { CoreUserProvider } from '@core/user/providers/user';\r\nimport { AddonModLessonProvider } from '../../providers/lesson';\r\nimport { AddonModLessonHelperProvider } from '../../providers/helper';\r\n\r\n/**\r\n * Page that displays a retake made by a certain user.\r\n */\r\n@IonicPage({ segment: 'addon-mod-lesson-user-retake' })\r\n@Component({\r\n    selector: 'page-addon-mod-lesson-user-retake',\r\n    templateUrl: 'user-retake.html',\r\n})\r\nexport class AddonModLessonUserRetakePage implements OnInit {\r\n\r\n    component = AddonModLessonProvider.COMPONENT;\r\n    lesson: any; // The lesson the retake belongs to.\r\n    courseId: number; // Course ID the lesson belongs to.\r\n    selectedRetake: number; // The retake to see.\r\n    student: any; // Data about the student and his retakes.\r\n    retake: any; // Data about the retake.\r\n    loaded: boolean; // Whether the data has been loaded.\r\n\r\n    protected lessonId: number; // The lesson ID the retake belongs to.\r\n    protected userId: number; // User ID to see the retakes.\r\n    protected retakeNumber: number; // Number of the initial retake to see.\r\n\r\n    constructor(navParams: NavParams, sitesProvider: CoreSitesProvider, protected textUtils: CoreTextUtilsProvider,\r\n            protected translate: TranslateService, protected domUtils: CoreDomUtilsProvider,\r\n            protected userProvider: CoreUserProvider, protected timeUtils: CoreTimeUtilsProvider,\r\n            protected lessonProvider: AddonModLessonProvider, protected lessonHelper: AddonModLessonHelperProvider) {\r\n\r\n        this.lessonId = navParams.get('lessonId');\r\n        this.courseId = navParams.get('courseId');\r\n        this.userId = navParams.get('userId') || sitesProvider.getCurrentSiteUserId();\r\n        this.retakeNumber = navParams.get('retake');\r\n    }\r\n\r\n    /**\r\n     * Component being initialized.\r\n     */\r\n    ngOnInit(): void {\r\n        // Fetch the data.\r\n        this.fetchData().finally(() => {\r\n            this.loaded = true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Change the retake displayed.\r\n     *\r\n     * @param {number} retakeNumber The new retake number.\r\n     */\r\n    changeRetake(retakeNumber: number): void {\r\n        this.loaded = false;\r\n\r\n        this.setRetake(retakeNumber).catch((error) => {\r\n            this.domUtils.showErrorModalDefault(error, 'Error getting attempt.');\r\n        }).finally(() => {\r\n            this.loaded = true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Pull to refresh.\r\n     *\r\n     * @param {any} refresher Refresher.\r\n     */\r\n    doRefresh(refresher: any): void {\r\n        this.refreshData().finally(() => {\r\n            refresher.complete();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get lesson and retake data.\r\n     *\r\n     * @return {Promise<any>} Promise resolved when done.\r\n     */\r\n    protected fetchData(): Promise<any> {\r\n        return this.lessonProvider.getLessonById(this.courseId, this.lessonId).then((lessonData) => {\r\n            this.lesson = lessonData;\r\n\r\n            // Get the retakes overview for all participants.\r\n            return this.lessonProvider.getRetakesOverview(this.lesson.id);\r\n        }).then((data) => {\r\n            // Search the student.\r\n            let student;\r\n\r\n            if (data && data.students) {\r\n                for (let i = 0; i < data.students.length; i++) {\r\n                    if (data.students[i].id == this.userId) {\r\n                        student = data.students[i];\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (!student) {\r\n                // Student not found.\r\n                return Promise.reject(this.translate.instant('addon.mod_lesson.cannotfinduser'));\r\n            }\r\n\r\n            if (!student.attempts || !student.attempts.length) {\r\n                // No retakes.\r\n                return Promise.reject(this.translate.instant('addon.mod_lesson.cannotfindattempt'));\r\n            }\r\n\r\n            student.bestgrade = this.textUtils.roundToDecimals(student.bestgrade, 2);\r\n            student.attempts.forEach((retake) => {\r\n                if (this.retakeNumber == retake.try) {\r\n                    // The retake specified as parameter exists. Use it.\r\n                    this.selectedRetake = this.retakeNumber;\r\n                }\r\n\r\n                retake.label = this.lessonHelper.getRetakeLabel(retake);\r\n            });\r\n\r\n            if (!this.selectedRetake) {\r\n                // Retake number not specified or not valid, use the last retake.\r\n                this.selectedRetake = student.attempts[student.attempts.length - 1].try;\r\n            }\r\n\r\n            // Get the profile image of the user.\r\n           return this.userProvider.getProfile(student.id, this.courseId, true).then((user) => {\r\n                student.profileimageurl = user.profileimageurl;\r\n\r\n                return student;\r\n            }).catch(() => {\r\n                // Error getting profile, resolve promise without adding any extra data.\r\n                return student;\r\n            });\r\n        }).then((student) => {\r\n            this.student = student;\r\n\r\n            return this.setRetake(this.selectedRetake);\r\n        }).catch((error) => {\r\n            this.domUtils.showErrorModalDefault(error, 'Error getting data.', true);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Refreshes data.\r\n     *\r\n     * @return {Promise<any>} Promise resolved when done.\r\n     */\r\n    protected refreshData(): Promise<any> {\r\n        const promises = [];\r\n\r\n        promises.push(this.lessonProvider.invalidateLessonData(this.courseId));\r\n        if (this.lesson) {\r\n            promises.push(this.lessonProvider.invalidateRetakesOverview(this.lesson.id));\r\n            promises.push(this.lessonProvider.invalidateUserRetakesForUser(this.lesson.id, this.userId));\r\n        }\r\n\r\n        return Promise.all(promises).catch(() => {\r\n            // Ignore errors.\r\n        }).then(() => {\r\n            return this.fetchData();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Set the retake to view and load its data.\r\n     *\r\n     * @param {number}retakeNumber Retake number to set.\r\n     * @return {Promise<any>} Promise resolved when done.\r\n     */\r\n    protected setRetake(retakeNumber: number): Promise<any> {\r\n        this.selectedRetake = retakeNumber;\r\n\r\n        return this.lessonProvider.getUserRetake(this.lessonId, retakeNumber, this.userId).then((data) => {\r\n\r\n            if (data && data.completed != -1) {\r\n                // Completed.\r\n                data.userstats.grade = this.textUtils.roundToDecimals(data.userstats.grade, 2);\r\n                data.userstats.timetakenReadable = this.timeUtils.formatTime(data.userstats.timetotake);\r\n            }\r\n\r\n            if (data && data.answerpages) {\r\n                // Format pages data.\r\n                data.answerpages.forEach((page) => {\r\n                    if (this.lessonProvider.answerPageIsContent(page)) {\r\n                        page.isContent = true;\r\n\r\n                        if (page.answerdata && page.answerdata.answers) {\r\n                            page.answerdata.answers.forEach((answer) => {\r\n                                // Content pages only have 1 valid field in the answer array.\r\n                                answer[0] = this.lessonHelper.getContentPageAnswerDataFromHtml(answer[0]);\r\n                            });\r\n                        }\r\n                    } else if (this.lessonProvider.answerPageIsQuestion(page)) {\r\n                        page.isQuestion = true;\r\n\r\n                        if (page.answerdata && page.answerdata.answers) {\r\n                            page.answerdata.answers.forEach((answer) => {\r\n                                // Only the first field of the answer array requires to be parsed.\r\n                                answer[0] = this.lessonHelper.getQuestionPageAnswerDataFromHtml(answer[0]);\r\n                            });\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            this.retake = data;\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/lesson/pages/user-retake/user-retake.ts"],"sourceRoot":""}